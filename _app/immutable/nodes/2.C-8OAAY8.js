import{s as U,n as Y,r as V,d as q}from"../chunks/scheduler.DHKgWpgq.js";import{S as B,i as F,e as w,s as E,c as k,d as A,m as O,h as I,g as T,n as _,j as M,k as d,o as P,p as N,q as G,b as S,f as y,l as j}from"../chunks/index.DC0thlrC.js";function x(s){return(s==null?void 0:s.length)!==void 0?s:Array.from(s)}function R(s,e,n){const c=s.slice();return c[9]=e[n],c}function D(s){let e,n,c=s[9].user+"",m,h,p,i,v=s[9].text+"",f,b,g;return{c(){e=w("p"),n=w("strong"),m=S(c),h=S(":"),i=E(),f=S(v),b=E(),this.h()},l(u){e=k(u,"P",{class:!0});var a=A(e);n=k(a,"STRONG",{class:!0});var l=A(n);m=y(l,c),h=y(l,":"),l.forEach(T),i=I(a),f=y(a,v),b=I(a),a.forEach(T),this.h()},h(){_(n,"class",p=q(s[9].user==="You"?"user-name":"ai-name")+" svelte-ceb9kg"),_(e,"class",g=(s[9].user==="You"?"user-message":"ai-message")+" "+s[9].className+" svelte-ceb9kg")},m(u,a){M(u,e,a),d(e,n),d(n,m),d(n,h),d(e,i),d(e,f),d(e,b)},p(u,a){a&2&&c!==(c=u[9].user+"")&&j(m,c),a&2&&p!==(p=q(u[9].user==="You"?"user-name":"ai-name")+" svelte-ceb9kg")&&_(n,"class",p),a&2&&v!==(v=u[9].text+"")&&j(f,v),a&2&&g!==(g=(u[9].user==="You"?"user-message":"ai-message")+" "+u[9].className+" svelte-ceb9kg")&&_(e,"class",g)},d(u){u&&T(e)}}}function H(s){let e,n,c="AI Chatbot",m,h,p,i,v,f,b="Send",g,u,a=x(s[1]),l=[];for(let t=0;t<a.length;t+=1)l[t]=D(R(s,a,t));return{c(){e=w("div"),n=w("h1"),n.textContent=c,m=E(),h=w("div");for(let t=0;t<l.length;t+=1)l[t].c();p=E(),i=w("input"),v=E(),f=w("button"),f.textContent=b,this.h()},l(t){e=k(t,"DIV",{class:!0});var r=A(e);n=k(r,"H1",{"data-svelte-h":!0}),O(n)!=="svelte-p7ibqx"&&(n.textContent=c),m=I(r),h=k(r,"DIV",{class:!0});var o=A(h);for(let C=0;C<l.length;C+=1)l[C].l(o);o.forEach(T),p=I(r),i=k(r,"INPUT",{placeholder:!0,class:!0}),v=I(r),f=k(r,"BUTTON",{class:!0,"data-svelte-h":!0}),O(f)!=="svelte-93q973"&&(f.textContent=b),r.forEach(T),this.h()},h(){_(h,"class","chat-window svelte-ceb9kg"),i.disabled=s[2],_(i,"placeholder","Talk to the robot..."),_(i,"class","svelte-ceb9kg"),_(f,"class","svelte-ceb9kg"),_(e,"class","chat-container svelte-ceb9kg")},m(t,r){M(t,e,r),d(e,n),d(e,m),d(e,h);for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(h,null);d(e,p),d(e,i),P(i,s[0]),d(e,v),d(e,f),g||(u=[N(i,"input",s[4]),N(i,"keydown",s[5]),N(f,"click",s[3])],g=!0)},p(t,[r]){if(r&2){a=x(t[1]);let o;for(o=0;o<a.length;o+=1){const C=R(t,a,o);l[o]?l[o].p(C,r):(l[o]=D(C),l[o].c(),l[o].m(h,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=a.length}r&4&&(i.disabled=t[2]),r&1&&i.value!==t[0]&&P(i,t[0])},i:Y,o:Y,d(t){t&&T(e),G(l,t),g=!1,V(u)}}}function J(s,e,n){let c="",m=[];const h=g=>{n(1,m=[...m,g])};let p=!1;const i="https://cohere-integration-api.onrender.com/api/cohere";console.log("url:",i);const v=async()=>{var g,u;if(c&&!p){n(2,p=!0);const a=new AbortController,l=setTimeout(()=>a.abort(),1e4);try{const t=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:c}),signal:a.signal});clearTimeout(l);const r=await t.json();if(console.log("response:",t,r),(u=(g=r==null?void 0:r.message)==null?void 0:g.content)!=null&&u[0]){const{text:o}=r.message.content[0];if(!o)throw new Error("AI error: malformed response");h({user:"You",text:c}),h({user:"AI",text:o}),n(0,c="")}else throw new Error(`AI error - code:${r.finishReason}`)}catch(t){h({user:"AI",text:"Error connecting to AI",className:"error-message"}),console.error("Error:",t)}finally{n(2,p=!1)}}console.log("messages:",m)};function f(){c=this.value,n(0,c)}return[c,m,p,v,f,g=>g.key==="Enter"&&v()]}class L extends B{constructor(e){super(),F(this,e,J,H,U,{})}}export{L as component};
